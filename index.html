<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kanban ‚Äî Otto Honeger</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f5f7fa; padding: 20px; }
    h1 { text-align: center; margin-bottom: 30px; color: #2c3e50; }
    .board { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; }
    .column { background: #e5e7eb; border-radius: 8px; padding: 15px; min-width: 300px; max-width: 400px; flex: 1; }
    .column h2 { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #d1d5db; font-size: 1.1rem; }
    .column.backlog h2 { border-color: #fbbf24; color: #b45309; }
    .column.rozpracovano h2 { border-color: #3b82f6; color: #1e40af; }
    .column.done h2 { border-color: #22c55e; color: #15803d; }
    .task { background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: grab; }
    .task p { word-break: break-word; }
    .task-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .task .delete { color: #ef4444; cursor: pointer; font-size: 1.1rem; }
    .add-form { margin-top: 15px; display: flex; gap: 8px; }
    .add-form input { flex: 1; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; }
    .add-form button { padding: 10px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; }
    .add-form button:hover { background: #2563eb; }
    .task .move-btn { font-size: 0.9rem; color: #6b7280; cursor: pointer; margin-left: 8px; }
  </style>
</head>
<body>
  <h1>üìù Otto Honeger ‚Äî Kanban</h1>
  <div class="board">
    <div class="column backlog" data-stage="backlog">
      <h2>üìù Backlog</h2>
      <div id="backlog-tasks"></div>
      <div class="add-form">
        <input type="text" placeholder="Nov√° polo≈æka..." data-stage="backlog" />
        <button class="add-btn">+</button>
      </div>
    </div>
    <div class="column rozpracovano" data-stage="rozpracovano">
      <h2>üöÄ Rozpracov√°no</h2>
      <div id="rozpracovano-tasks"></div>
      <div class="add-form">
        <input type="text" placeholder="P≈ôesunout task..." data-stage="rozpracovano" />
        <button class="add-btn">+</button>
      </div>
    </div>
    <div class="column done" data-stage="done">
      <h2>‚úÖ Hotovo</h2>
      <div id="done-tasks"></div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "otto-kanban-v1";
    const stages = ["backlog", "rozpracovano", "done"];

    let tasks = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
      render();
    }

    function render() {
      stages.forEach(stage => {
        const container = document.getElementById(stage + "-tasks");
        container.innerHTML = tasks
          .filter(t => t.stage === stage)
          .map(t => `
            <div class="task" data-id="${t.id}">
              <div class="task-header">
                <span>ü™µ ${t.title}</span>
                <span class="delete" onclick="removeTask('${t.id}')">‚ùå</span>
              </div>
              <small style="color:#6b7280">ID: ${t.id.slice(-6)}</small>
            </div>
          `).join("");
      });
    }

    function addTask(stage) {
      const input = document.querySelector(`input[data-stage="${stage}"]`);
      const title = input.value.trim();
      if (!title) return;
      tasks.push({
        id: Math.random().toString(36).substr(2, 9),
        title: title,
        stage: stage
      });
      input.value = "";
      save();
    }

    window.removeTask = function(id) {
      if (confirm("Smazat task?")) {
        tasks = tasks.filter(t => t.id !== id);
        save();
      }
    };

    // Bind add buttons
    document.querySelectorAll(".add-btn").forEach(btn => {
      btn.onclick = () => {
        const input = btn.previousElementSibling;
        const stage = input.dataset.stage;
        addTask(stage);
      };
    });

    // Enter key support
    document.querySelectorAll("input").forEach(input => {
      input.addEventListener("keypress", e => {
        if (e.key === "Enter") addTask(input.dataset.stage);
      });
    });

    render();
  </script>
</body>
</html>
